---
layout: the
title: 工作中遇到的问题
date: 2018-06-25 17:27:03
tags:
---

### 此博客专用记录自己工作中遇到的各种问题

1.2018-6-25
  手机网页在 OPPO 和华为某机型上无法打开，后来发现是某行字符串使用反引号 ` 来标记的。换成单引号，解决。
<!-- more -->

2.2018-6-25
  有一个页面因为有文件上传的功能，所以提交的时候以 FormData 提交的，结果在 iphone6 上出现错误。后来定位到是数据格式不正确， ios 对 FormData 不是特别支持。之前是在页面新建 form 表单，然后把需要提交的变量和值赋值给 form 表单里面的 input 标签，然后在 js 里面执行

    var dataParams = new FormData(document.getElementById("form"))
  
  直接把 form 表单转化成 FormData 格式，但是在 iphone6 和 iphone6s 上不行，只能用

    var dataParams = new FormData()
  
  然后一项一项的用 FormData 的 append 方法放进去，解决。

3.2018-6-25
  前些天有个同事微信公众号页面在手机端和微信web开发者工具里面可以正常打开，但是在 pc 端微信浏览器缺显示错误，后经排查是在 js 里面使用了 es6 的箭头函数，换成普通方法后就可以了。过了几天另个同事也出现了同样的问题，发现是使用了 let 运算符，换成 var ，解决。

4.2018-6-27
  这些天在做一个统计用户页面行为的功能，在用户操作页面的时候把相应的数据存下来，然后在浏览器刷新、关闭以及切换网页的时候传输到后台。刚开始用的 window.onbeforeunload 事件，但是后来发现在用户关闭页面的时候不会执行，然后又用 window.onunload 事件，结果微信浏览器还是没用。这时候 google 的用处就体现出来了，有一篇文章介绍了 pagehide 事件，应用之后发现完美，（百度引擎是真滴垃圾）解决。